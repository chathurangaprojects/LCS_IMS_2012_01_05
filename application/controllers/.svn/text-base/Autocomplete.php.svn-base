<?php
	if ( ! defined('BASEPATH')) exit('No direct script access allowed');

	class Autocomplete extends CI_Controller
	{
		function __construct()
		{
			parent::__construct();
		
			$this->load->model('ItemMaster/ItemMasterModel');
			$this->load->model('ItemMaster/ItemMasterService');
		}
		
		
		public function loadItemTypes()
		{
			$itemMasterModel = new ItemMasterModel();
			$itemMasterService = new ItemMasterService();
			
			$keywords = trim(strtolower($this->input->get('q', TRUE)));
			
			$itemMasterModel->setItem_Name($keywords);
			
			if(!empty($keywords))
			{
				$results = $itemMasterService->loadItemTypes($itemMasterModel);
				
				if(!empty($results))
				{
					foreach ($results->result_array() as $row)
					{
						if(! empty($row['Category_Name']))
						{
							$cname = $row['Item_Type'] . ' - ' . $row['Category_Name'] . ' - ' . $row['Type_Code'];
						}
						else
						{
							$cname = $row['Item_Type'] . ' - (Undefined) - ' . $row['Type_Code'];
						}
					
						echo "$cname\n";
					}
				}
			}
		}
	}
?>